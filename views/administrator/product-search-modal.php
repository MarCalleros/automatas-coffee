<div class="search-product-trigger">
    <button type="button" id="open-product-search" class="btn-search-product">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
        </svg>
        Buscar Producto
    </button>
</div>

<div id="product-search-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Buscar Producto</h3>
            <button type="button" id="close-modal" class="close-button">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="search-container">
                <div class="search-input-wrapper">
                    <input 
                        type="text" 
                        id="product-search-input" 
                        class="search-input" 
                        placeholder="Escribe el nombre del producto..."
                        autocomplete="off"
                    >
                    <div class="loading-spinner" id="search-loading"></div>
                    <div id="product-analysis" class="product-analysis" style="display: none;">
                        <div class="analysis-header">
                            <button type="button" id="back-to-results" class="btn-back">
                                ← Volver a resultados
                            </button>
                            <h2 id="product-title"></h2>
                        </div>
                        <div class="analysis-content">
                            <!-- Contenido dinámico -->
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value" id="total-sales"></div>
                                    <div class="stat-label">Ventas totales</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="total-revenue"></div>
                                    <div class="stat-label">Ingresos generados</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="stock-available"></div>
                                        <div class="stat-label">Stock disponible</div>
                                        </div>
                                    <div class="stat-card">
                                        <div class="stat-value" id="unit-price"></div>
                                        <div class="stat-label">Precio unitario</div>
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="search-results" class="search-results" style="display: none;">
                <div class="search-results-header">
                    <span class="results-count" id="results-count">0 productos encontrados</span>
                    <button type="button" id="clear-search" class="clear-search">Limpiar</button>
                </div>
                
                <div class="products-list" id="products-list">
                    <!-- Los productos se cargan dinámicamente -->
                </div>
            </div>

            <div id="empty-state" class="empty-state">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
                <h4>Busca un producto</h4>
                <p>Escribe el nombre del producto que deseas analizar</p>
            </div>

            <div id="no-results" class="no-results" style="display: none;">
                <svg class="icon-coffee" width="160" height="100" viewBox="0 0 160 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M78.0397 39.1593C76.8682 40.3797 76.7471 40.4203 73.9194 40.2576C70.6071 40.0136 69.5568 40.3797 70.1627 41.5593C70.7686 42.6576 73.1115 44 74.5254 44C77.5953 44 81.2309 41.2746 80.9885 39.1593C80.8269 37.6136 79.4939 37.6136 78.0397 39.1593Z" fill="#CFCFD7"/>
                <path d="M121.077 38.9045C120.609 39.8086 120.034 41.1237 118.812 44.2883C117.519 47.6172 117.77 50.6174 119.567 52.6312C121.364 54.6861 122.909 54.4395 125.21 51.8092C126.432 50.4119 126.216 46.672 124.706 42.6444C122.945 37.9181 122.083 37.0551 121.077 38.9045Z" fill="#CFCFD7"/>
                <path d="M96.2694 40.2764C95.779 40.7428 95.9833 42.2585 96.6782 43.4244C97.0869 44.0851 98.2722 45.1345 99.3349 45.7952C100.929 46.8057 101.665 47 103.667 47C105.711 47 106.202 46.8445 107.019 46.0284L108 45.0568L107.101 44.2017C106.406 43.541 106.12 43.4244 105.711 43.8131C104.485 44.979 101.215 43.8519 99.1714 41.5589C97.8226 40.082 96.8825 39.6545 96.2694 40.2764Z" fill="#CFCFD7"/>
                <path d="M78.4759 47.367C76.7361 49.5422 75.32 49.6368 74.0658 47.6507C73.0947 46.0429 71.8809 45.901 71.1526 47.2724C70.829 47.9344 70.9908 48.5019 71.9214 50.0624C74.1871 53.7982 77.4239 53.9873 79.9325 50.5353C81.1463 48.8329 81.3486 47.1305 80.418 46.2321C79.892 45.7592 79.5683 45.9483 78.4759 47.367Z" fill="#CFCFD7"/>
                <path d="M95.1341 48.7651C94.2885 51.3759 97.5905 55 100.852 55C102.544 55 105 52.8957 105 51.4539C105 50.5576 104.839 50.3238 104.154 50.3238C103.711 50.3238 102.866 50.6745 102.302 51.1032C101.738 51.5318 101.054 51.8825 100.732 51.8825C99.8859 51.8825 97.8321 49.9731 97.6711 49.0378C97.51 47.8298 95.4965 47.596 95.1341 48.7651Z" fill="#CFCFD7"/>
                <path d="M82.0727 56.8285C79.2514 58.465 77.1725 62.188 78.3233 63.4563C78.8801 64.07 80.4764 63.2927 80.7734 62.229C80.9219 61.8198 81.5159 61.0425 82.1841 60.5106C83.1493 59.7333 83.8175 59.5696 86.0078 59.5287C89.6459 59.4878 91.2422 60.6334 92.8385 64.3973C93.915 66.8521 94.1007 67.0976 95.0287 66.9748C95.9197 66.8521 96.0311 66.6884 95.9939 65.4201C95.9197 62.2699 93.4696 58.5059 90.4626 56.8285C88.4951 55.7238 83.966 55.7238 82.0727 56.8285Z" fill="#CFCFD7"/>
                <path d="M89.7146 0.173805C84.1282 0.412529 82.4402 0.651253 77.0547 2.00402C73.6787 2.83955 70.5841 4.07296 67.2885 5.90318C64.5957 7.33551 61.5815 10.9959 60.6571 13.8606C58.6074 20.3062 57.5624 34.7887 58.3261 45.77C58.8083 52.5736 59.2504 55.1598 60.6571 59.7353C61.1394 61.2074 61.1796 61.9634 60.8982 62.2419C60.6169 62.5204 56.1156 62.7989 49.2833 63.0377C35.0559 63.5151 27.5002 64.47 23.0793 66.4196C22.3558 66.7379 21.5922 66.9766 21.3913 66.9766C20.7884 66.9766 18.0555 68.9262 17.2919 69.8811C16.0862 71.393 16.3675 73.4221 18.0555 75.0534C18.8593 75.8889 19.8239 76.5255 20.1856 76.5255C20.5473 76.5255 21.1903 76.804 21.6324 77.1223C22.0343 77.4406 22.6774 77.7191 23.0391 77.7191C24.2448 77.7191 27.4198 79.3106 27.8217 80.1064C28.7863 81.8968 26.616 83.6474 21.9941 84.8411C19.8239 85.3981 16.3675 87.2283 15.202 88.4219C13.1121 90.5704 13.8355 94.2706 16.689 95.8621C21.2305 98.4881 30.2733 100 41.4864 100C55.3118 100 62.1843 98.13 64.3546 93.7932C65.4397 91.6845 66.5249 91.2468 71.629 90.8091C87.9462 89.4962 94.0953 87.7853 96.5469 83.8862L97.4311 82.4936H102.294C107.157 82.4936 109.77 82.0957 114.954 80.5043C117.205 79.7881 117.968 79.4698 119.857 78.4751C120.179 78.2762 121.264 77.7191 122.228 77.2417C124.76 75.9287 129.181 71.7511 131.11 68.8466C131.995 67.4938 132.758 66.2604 132.798 66.1013C132.879 65.9421 134.567 65.5045 136.536 65.1464C140.957 64.3506 143.208 63.5549 147.789 61.0881C149.357 60.2525 152.733 57.0696 154.582 54.6823C158.199 49.9874 159.686 45.6108 159.927 38.7674C160.088 34.7091 160.007 33.5553 159.445 32.2025C158.038 28.94 157.395 27.9055 155.667 26.1549C153.135 23.6085 150.442 22.2557 146.383 21.5793C143.851 21.1019 143.168 20.6642 143.168 19.391C143.168 17.9985 142.002 15.2532 140.636 13.5423C139.269 11.8315 134.607 8.21084 132.718 7.45488C132.397 7.29573 130.99 6.69891 129.583 6.06232C128.217 5.42572 126.931 4.90849 126.69 4.90849C126.489 4.90849 125.725 4.66976 125.002 4.35146C123.273 3.63529 119.978 2.72019 116.441 1.96423C108.122 0.173805 100.928 -0.303642 89.7146 0.173805ZM105.992 3.67509C110.372 4.19232 116.602 5.30637 117.446 5.70424C117.808 5.86339 118.893 6.1419 119.857 6.30105C120.862 6.4602 121.867 6.73871 122.068 6.89786C122.309 7.05701 123.113 7.33552 123.876 7.49467C124.64 7.65382 125.524 7.93233 125.886 8.13126C126.207 8.3302 127.413 8.84743 128.498 9.28509C132.678 10.9959 136.375 13.5025 138.184 15.85C139.711 17.8393 139.952 20.6245 138.747 22.1364L137.862 23.2106L136.858 21.7385C135.853 20.2664 135.21 19.6298 132.999 17.7598C131.794 16.7651 126.288 14.0596 125.403 14.0596C125.122 14.0596 124.68 13.9004 124.479 13.7015C124.037 13.3036 118.812 11.6723 117.968 11.6723C117.687 11.6723 117.124 11.5132 116.722 11.3142C114.793 10.3196 101.691 8.72807 95.5422 8.72807C91.2016 8.72807 83.3645 9.5636 80.4709 10.2798C77.7781 10.9959 77.537 11.0755 74.3619 12.4283C73.317 12.9057 72.3524 13.2638 72.2319 13.2638C71.83 13.2638 66.2435 16.964 65.922 17.4415C65.3995 18.1576 64.1938 17.0436 64.0733 15.7306C63.9125 14.0596 65.2388 11.6325 67.1679 10.1206C69.0568 8.64849 73.9199 6.1021 74.8442 6.1021C75.2059 6.1021 75.648 5.98275 75.7686 5.8236C76.3313 5.30637 81.7168 4.15253 85.776 3.71487C88.0668 3.47615 89.9959 3.15785 90.1165 3.03849C90.3978 2.75998 101.852 3.19764 105.992 3.67509ZM63.4704 22.1364C64.3546 23.5687 69.1372 26.513 72.8347 27.9055C84.6908 32.3219 107.238 34.7091 120.942 32.9585C125.283 32.4015 129.262 31.5659 131.311 30.7702C133.442 29.9347 138.345 27.4281 138.345 27.1098C138.345 26.9506 138.626 26.7915 138.948 26.7915C139.751 26.7915 139.751 29.2981 138.988 33.4359C138.666 35.1468 138.184 37.6136 137.943 38.9266C137.702 40.2396 137.34 42.2289 137.179 43.343C136.978 44.457 136.617 45.77 136.375 46.2076C136.134 46.6453 135.933 47.4808 135.933 48.0379C135.933 48.5949 135.692 49.7487 135.371 50.5445C135.089 51.38 134.527 53.1306 134.125 54.4436C132.075 61.4064 129.061 67.096 125.524 70.5972C120.701 75.3717 114.351 78.2364 106.394 79.3106C102.375 79.8279 99.722 79.8279 95.3814 79.2708C81.1139 77.56 72.2319 73.1038 66.6454 64.8679C65.6407 63.3957 64.7967 62.043 64.7967 61.8042C64.7967 61.6053 64.5555 60.8494 64.234 60.1332C63.3498 58.0642 62.5058 54.4038 61.7824 49.4304C60.6571 41.9106 61.4609 21.6191 62.8675 21.6191C63.0283 21.6191 63.3096 21.8579 63.4704 22.1364ZM147.146 24.8419C152.652 26.5527 155.667 29.8551 156.832 35.4651C157.234 37.4942 157.274 38.5287 156.872 40.8364C156.27 44.2581 155.144 47.6798 154.019 49.51C153.577 50.2659 153.054 51.2208 152.853 51.6585C152.371 52.6134 149.116 56.0351 147.267 57.5072C145.539 58.86 141.56 60.7698 138.787 61.5655C135.371 62.5602 134.286 62.3613 135.25 60.8494C135.531 60.3719 136.014 59.2579 136.295 58.303C136.697 56.9104 137.018 56.5125 138.305 55.9953C142.243 54.4436 144.614 52.693 147.388 49.2713C149.236 47.0432 150 45.4915 150.964 42.2687C151.768 39.4438 151.768 37.9319 150.924 35.2264C150.04 32.5208 148.071 30.5315 145.378 29.6562C143.529 29.0196 143.368 28.8604 143.248 27.627C143.007 25.3591 143.449 24.4042 144.655 24.4042C145.257 24.4042 146.383 24.6032 147.146 24.8419ZM146.423 33.9134C147.95 35.4253 147.99 35.5049 147.99 38.4491C147.99 41.2342 147.548 43.0645 146.343 45.0936C146.142 45.4119 145.82 46.0883 145.619 46.5657C144.775 48.4357 139.229 53.0113 138.586 52.3747C138.184 51.9768 138.305 50.5842 138.907 48.8734C139.229 47.9981 139.792 45.8496 140.153 44.0989C140.515 42.3483 141.078 39.8019 141.399 38.4491C141.721 37.0964 141.962 35.2662 141.962 34.4306C141.962 32.6004 142.163 32.3617 143.69 32.3617C144.534 32.3617 145.338 32.7993 146.423 33.9134Z" fill="#CFCFD7"/>
                <path d="M2.78185 81.7188C1.89208 82.0509 0.875205 82.7485 0.493877 83.2135C-0.141672 83.9442 -0.141672 84.1435 0.366767 84.8742C1.38364 86.4021 3.62925 87 8.20519 87C11.2982 87 12.6117 86.8671 13.5862 86.4021C17.0181 84.9407 16.7639 82.9477 12.993 81.6524C10.5355 80.7555 4.94271 80.7888 2.78185 81.7188Z" fill="#CFCFD7"/>
                </svg>
                <h4>No se encontraron productos</h4>
                <p>Intenta con otro término de búsqueda</p>
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" id="cancel-search" class="btn-cancel">Cancelar</button>
            <button type="button" id="analyze-selected" class="btn-analyze" disabled>Analizar Producto</button>
        </div>
    </div>
</div>